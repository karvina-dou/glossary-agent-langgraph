Wi-Fi Protected Access(WPA),Wi-Fi Protected Access 2(WPA2), andWi-Fi Protected Access 3(WPA3) are the three security certification programs developed after 2000 by theWi-Fi Allianceto secure wireless computer networks. The Alliance defined these in response to serious weaknesses researchers had found in the previous system,Wired Equivalent Privacy(WEP).
WPA (sometimes referred to as the TKIP standard) became available in 2003. The Wi-Fi Alliance intended it as an intermediate measure in anticipation of the availability of the more secure and complex WPA2, which became available in 2004 and is a common shorthand for the full IEEE 802.11i (orIEEE 802.11i-2004) standard.
In January 2018, the Wi-Fi Alliance announced the release of WPA3, which has several security improvements over WPA2.
As of 2023, most computers that connect to a wireless network have support for using WPA, WPA2, or WPA3.
WEP (Wired Equivalent Privacy) was an early encryption protocol for wireless networks, designed to secure WLAN connections. It supported 64-bit and 128-bit keys, combining user-configurable and factory-set bits. WEP used the RC4 algorithm for encrypting data, creating a unique key for each packet by combining a new Initialization Vector (IV) with a shared key (it has 40 bits of vectored key and 24 bits of random numbers). Decryption involved reversing this process, using the IV and the shared key to generate a key stream and decrypt the payload. Despite its initial use, WEP's significant vulnerabilities led to the adoption of more secure protocols.
The Wi-Fi Alliance intended WPA as an intermediate measure to take the place ofWEPpending the availability of the fullIEEE 802.11istandard. WPA could be implemented throughfirmware upgradesonwireless network interface cardsdesigned for WEP that began shipping as far back as 1999. However, since the changes required in thewireless access points(APs) were more extensive than those needed on the network cards, most pre-2003 APs could not be upgraded to support WPA.
The WPA protocol implements theTemporal Key Integrity Protocol(TKIP). WEP used a 64-bit or 128-bit encryption key that must be manually entered on wireless access points and devices and does not change. TKIP employs a per-packet key, meaning that it dynamically generates a new 128-bit key for each packet and thus prevents the types of attacks that compromised WEP.
WPA also includes aMessage Integrity Check, which is designed to prevent an attacker from altering and resending data packets. This replaces thecyclic redundancy check(CRC) that was used by the WEP standard. CRC's main flaw was that it did not provide a sufficiently strongdata integrityguarantee for the packets it handled.Well-testedmessage authentication codesexisted to solve these problems, but they required too much computation to be used on old network cards. WPA uses a message integrity check algorithm calledTKIPto verify the integrity of the packets. TKIP is much stronger than a CRC, but not as strong as the algorithm used in WPA2. Researchers have since discovered a flaw in WPA that relied on older weaknesses in WEP and the limitations of the message integrity code hash function, namedMichael, to retrieve the keystream from short packets to use for re-injection andspoofing.
Ratified in 2004, WPA2 replaced WPA. WPA2, which requires testing and certification by the Wi-Fi Alliance, implements the mandatory elements of IEEE 802.11i. In particular, it includes support forCCMP, anAES-based encryption mode.Certification began in September, 2004. From March 13, 2006, to June 30, 2020, WPA2 certification was mandatory for all new devices to bear the Wi-Fi trademark.In WPA2-protected WLANs, secure communication is established through a multi-step process. Initially, devices associate with the Access Point (AP) via an association request. This is followed by a 4-way handshake, a crucial step ensuring both the client and AP have the correct Pre-Shared Key (PSK) without actually transmitting it. During this handshake, a Pairwise Transient Key (PTK) is generated for secure data exchange.
WPA2 employs the Advanced Encryption StandardAESwith a 128-bit key, enhancing security through the Counter-Mode/CBC-Mac ProtocolCCMP. This protocol ensures robust encryption and data integrity, using different Initialization Vectors (IVs) for encryption and authentication purposes.
The 4-way handshake involves:
Post-handshake, the established PTK is used for encrypting unicast traffic, and the Group Temporal Key (GTK) is used for broadcast traffic. This comprehensive authentication and encryption mechanism is what makes WPA2 a robust security standard for wireless networks.
In January 2018, the Wi-Fi Alliance announced WPA3 as a replacement to WPA2.Certification began in June 2018,and WPA3 support has been mandatory for devices which bear the "Wi-Fi CERTIFIED™" logo since July 2020.
The new standard uses an equivalent 192-bit cryptographic strength in WPA3-Enterprise mode(AES-256inGCM modewithSHA-384asHMAC), and still mandates the use ofCCMP-128(AES-128inCCM mode) as the minimum encryption algorithm in WPA3-Personal mode.TKIPis not allowed in WPA3.
The WPA3 standard also replaces thepre-shared key(PSK) exchange withSimultaneous Authentication of Equals(SAE) exchange, a method originally introduced withIEEE 802.11s, resulting in a more secure initial key exchange in personal modeandforward secrecy.The Wi-Fi Alliance also says that WPA3 will mitigate security issues posed by weak passwords and simplify the process of setting up devices with no display interface.WPA3 also supportsOpportunistic Wireless Encryption (OWE)for open Wi-Fi networks that do not have passwords.
Protection of management frames as specified in theIEEE 802.11wamendment is also enforced by the WPA3 specifications.
WPA has been designed specifically to work with wireless hardware produced prior to the introduction of WPA protocol,which provides inadequate security throughWEP. Some of these devices support WPA only after applying firmware upgrades, which are not available for some legacy devices.
Wi-Fi devices certified since 2006 support both the WPA and WPA2 security protocols. WPA3 is required since July 1, 2020.
Different WPA versions and protection mechanisms can be distinguished based on the target end-user (such as WEP, WPA, WPA2, WPA3) and the method of authentication key distribution, as well as the encryption protocol used. As of July 2020, WPA3 is the latest iteration of the WPA standard, bringing enhanced security features and addressing vulnerabilities found in WPA2. WPA3 improves authentication methods and employs stronger encryption protocols, making it the recommended choice for securing Wi-Fi networks.
Also referred to asWPA-PSK(pre-shared key) mode, this is designed for home, small office and basic uses and does not require an authentication server.Each wireless network device encrypts the network traffic by deriving its 128-bit encryption key from a 256-bit sharedkey. This key may be entered either as a string of 64hexadecimaldigits, or as apassphraseof 8 to 63printable ASCII characters.This pass-phrase-to-PSK mapping is nevertheless not binding, as Annex J is informative in the latest 802.11 standard.If ASCII characters are used, the 256-bit key is calculated by applying thePBKDF2key derivation functionto the passphrase, using theSSIDas thesaltand 4096 iterations ofHMAC-SHA1.WPA-Personal mode is available on all three WPA versions.
This enterprise mode uses an802.1Xserver for authentication, offering higher security control by replacing the vulnerable WEP with the more advanced TKIP encryption. TKIP ensures continuous renewal of encryption keys, reducing security risks. Authentication is conducted through aRADIUSserver, providing robust security, especially vital in corporate settings. This setup allows integration with Windows login processes and supports various authentication methods likeExtensible Authentication Protocol, which uses certificates for secure authentication, and PEAP, creating a protected environment for authentication without requiring client certificates.
Originally, only EAP-TLS (Extensible Authentication Protocol-Transport Layer Security) was certified by the Wi-Fi alliance. In April 2010, theWi-Fi Allianceannounced the inclusion of additional EAPtypes to its WPA- and WPA2-Enterprise certification programs.This was to ensure that WPA-Enterprise certified products can interoperate with one another.
As of 2010the certification program includes the following EAP types:
802.1X clients and servers developed by specific firms may support other EAP types. This certification is an attempt for popular EAP types to interoperate; their failure to do so as of 2013is one of the major issues preventing rollout of 802.1X on heterogeneous networks.
Commercial 802.1X servers include MicrosoftNetwork Policy ServerandJuniper NetworksSteelbelted RADIUS as well as Aradial Radius server.FreeRADIUSis an open source 802.1X server.
WPA-Personal and WPA2-Personal remain vulnerable topassword crackingattacks if users rely on aweak password or passphrase. WPA passphrase hashes are seeded from the SSID name and its length;rainbow tablesexist for the top 1,000 network SSIDs and a multitude of common passwords, requiring only a quick lookup to speed up cracking WPA-PSK.
Brute forcing of simple passwords can be attempted using theAircrack Suitestarting from the four-way authentication handshake exchanged during association or periodic re-authentication.
WPA3 replaces cryptographic protocols susceptible to off-line analysis with protocols that require interaction with the infrastructure for each guessed password, supposedly placing temporal limits on the number of guesses.However, design flaws in WPA3 enable attackers to plausibly launch brute-force attacks (see§ Dragonblood).
WPA and WPA2 do not provideforward secrecy, meaning that once an adverse person discovers the pre-shared key, they can potentially decrypt all packets encrypted using that PSK transmitted in the future and even past, which could be passively and silently collected by the attacker. This also means an attacker can silently capture and decrypt others' packets if a WPA-protected access point is provided free of charge at a public place, because its password is usually shared to anyone in that place. In other words, WPA only protects from attackers who do not have access to the password. Because of that, it's safer to useTransport Layer Security(TLS) or similar on top of that for the transfer of any sensitive data. However starting from WPA3, this issue has been addressed.
In 2013, Mathy Vanhoef and Frank Piessenssignificantly improved upon theWPA-TKIPattacks of Erik Tews and Martin Beck.They demonstrated how to inject an arbitrary number of packets, with each packet containing at most 112 bytes of payload. This was demonstrated by implementing aport scanner, which can be executed against any client usingWPA-TKIP. Additionally, they showed how to decrypt arbitrary packets sent to a client. They mentioned this can be used to hijack aTCP connection, allowing an attacker to inject maliciousJavaScriptwhen the victim visits a website.
In contrast, the Beck-Tews attack could only decrypt short packets with mostly known content, such asARPmessages, and only allowed injection of 3 to 7 packets of at most 28 bytes. The Beck-Tews attack also requiresquality of service(as defined in802.11e) to be enabled, while the Vanhoef-Piessens attack does not. Neither attack leads to recovery of the shared session key between the client andAccess Point. The authors say using a short rekeying interval can prevent some attacks but not all, and strongly recommend switching fromTKIPto AES-basedCCMP.
Halvorsen and others show how to modify the Beck-Tews attack to allow injection of 3 to 7 packets having a size of at most 596 bytes.The downside is that their attack requires substantially more time to execute: approximately 18 minutes and 25 seconds. In other work Vanhoef and Piessens showed that, when WPA is used to encrypt broadcast packets, their original attack can also be executed.This is an important extension, as substantially more networks use WPA to protectbroadcast packets, than to protectunicast packets. The execution time of this attack is on average around 7 minutes, compared to the 14 minutes of the original Vanhoef-Piessens and Beck-Tews attack.
The vulnerabilities of TKIP are significant because WPA-TKIP had been held before to be an extremely safe combination; indeed, WPA-TKIP is still a configuration option upon a wide variety of wireless routing devices provided by many hardware vendors. A survey in 2013 showed that 71% still allow usage of TKIP, and 19% exclusively support TKIP.
A more serious security flaw was revealed in December 2011 by Stefan Viehböck that affects wireless routers with theWi-Fi Protected Setup(WPS) feature, regardless of which encryption method they use. Most recent models have this feature and enable it by default. Many consumer Wi-Fi device manufacturers had taken steps to eliminate the potential of weak passphrase choices by promoting alternative methods of automatically generating and distributing strong keys when users add a new wireless adapter or appliance to a network. These methods include pushing buttons on the devices or entering an 8-digitPIN.
The Wi-Fi Alliance standardized these methods as Wi-Fi Protected Setup; however, the PIN feature as widely implemented introduced a major new security flaw. The flaw allows a remote attacker to recover the WPS PIN and, with it, the router's WPA/WPA2 password in a few hours.Users have been urged to turn off the WPS feature,although this may not be possible on some router models. Also, the PIN is written on a label on most Wi-Fi routers with WPS, which cannot be changed if compromised.
In 2018, the Wi-Fi Alliance introduced Wi-Fi Easy Connectas a new alternative for the configuration of devices that lack sufficient user interface capabilities by allowing nearby devices to serve as an adequate UI for network provisioning purposes, thus mitigating the need for WPS.
Several weaknesses have been found inMS-CHAPv2, some of which severely reduce the complexity of brute-force attacks, making them feasible with modern hardware. In 2012 the complexity of breaking MS-CHAPv2 was reduced to that of breaking a singleDESkey (work byMoxie Marlinspikeand Marsh Ray). Moxie advised: "Enterprises who are depending on the mutual authentication properties of MS-CHAPv2 for connection to their WPA2 Radius servers should immediately start migrating to something else."
Tunneled EAP methods using TTLS or PEAP which encrypt the MSCHAPv2 exchange are widely deployed to protect against exploitation of this vulnerability. However, prevalent WPA2 client implementations during the early 2000s were prone to misconfiguration by end users, or in some cases (e.g.Android), lacked any user-accessible way to properly configure validation of AAA server certificate CNs. This extended the relevance of the original weakness in MSCHAPv2 withinMiTMattack scenarios.Under stricter compliance tests for WPA2 announced alongside WPA3, certified client software will be required to conform to certain behaviors surrounding AAA certificate validation.
Hole196 is a vulnerability in the WPA2 protocol that abuses the shared Group Temporal Key (GTK). It can be used to conduct man-in-the-middle anddenial-of-serviceattacks. However, it assumes that the attacker is already authenticated against Access Point and thus in possession of the GTK.
In 2016 it was shown that the WPA and WPA2 standards contain an insecure expositoryrandom number generator(RNG). Researchers showed that, if vendors implement the proposed RNG, an attacker is able to predict the group key (GTK) that is supposed to be randomly generated by theaccess point(AP). Additionally, they showed that possession of the GTK enables the attacker to inject any traffic into the network, and allowed the attacker to decrypt unicast internet traffic transmitted over the wireless network. They demonstrated their attack against anAsusRT-AC51U router that uses theMediaTekout-of-tree drivers, which generate the GTK themselves, and showed the GTK can be recovered within two minutes or less. Similarly, they demonstrated the keys generated by Broadcom access daemons running on VxWorks 5 and later can be recovered in four minutes or less, which affects, for example, certain versions of Linksys WRT54G and certain Apple AirPort Extreme models. Vendors can defend against this attack by using a secure RNG. By doing so,Hostapdrunning on Linux kernels is not vulnerable against this attack and thus routers running typicalOpenWrtorLEDEinstallations do not exhibit this issue.
In October 2017, details of theKRACK(Key Reinstallation Attack) attack on WPA2 were published.The KRACK attack is believed to affect all variants of WPA and WPA2; however, the security implications vary between implementations, depending upon how individual developers interpreted a poorly specified part of the standard. Software patches can resolve the vulnerability but are not available for all devices.KRACK exploits a weakness in the WPA2 4-Way Handshake, a critical process for generating encryption keys. Attackers can force multiple handshakes, manipulating key resets. By intercepting the handshake, they could decrypt network traffic without cracking encryption directly. This poses a risk, especially with sensitive data transmission.
Manufacturers have released patches in response, but not all devices have received updates. Users are advised to keep their devices updated to mitigate such security risks. Regular updates are crucial for maintaining network security against evolving threats.
The Dragonblood attacks exposed significant vulnerabilities in the Dragonfly handshake protocol used in WPA3 and EAP-pwd. These included side-channel attacks potentially revealing sensitive user information and implementation weaknesses in EAP-pwd and SAE. Concerns were also raised about the inadequate security in transitional modes supporting both WPA2 and WPA3. In response, security updates and protocol changes are being integrated into WPA3 and EAP-pwd to address these vulnerabilities and enhance overall Wi-Fi security.
On May 11, 2021, FragAttacks, a set of new security vulnerabilities, were revealed, affecting Wi-Fi devices and enabling attackers within range to steal information or target devices. These include design flaws in the Wi-Fi standard, affecting most devices, and programming errors in Wi-Fi products, making almost all Wi-Fi products vulnerable. The vulnerabilities impact all Wi-Fi security protocols, including WPA3 and WEP. Exploiting these flaws is complex but programming errors in Wi-Fi products are easier to exploit. Despite improvements in Wi-Fi security, these findings highlight the need for continuous security analysis and updates. In response, security patches were developed, and users are advised to use HTTPS and install available updates for protection.