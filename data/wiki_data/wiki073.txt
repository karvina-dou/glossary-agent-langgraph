Multiprotocol Label Switching(MPLS) is a routing technique intelecommunications networksthat directs data from onenodeto the next based on labels rather than network addresses.Whereas network addresses identifyendpoints, the labels identify established paths between endpoints. MPLS can encapsulate packets of variousnetwork protocols, hence themultiprotocolcomponent of the name. MPLS supports a range of access technologies, includingT1/E1,ATM,Frame Relay, andDSL.
In an MPLS network, labels are assigned to data packets. Packet-forwarding decisions are made solely on the contents of this label, without the need to examine the packet itself. This allows one to create end-to-end circuits across any type of transport medium, using any protocol. The primary benefit is to eliminate dependence on a particularOSI modeldata link layer(layer 2) technology, and eliminate the need for multiple layer-2 networks to satisfy different types of traffic. Multiprotocol label switching belongs to the family ofpacket-switched networks.
MPLS operates at a layer that is generally considered to lie between traditional definitions of OSI Layer 2 (data link layer) and Layer 3 (network layer), and thus is often referred to as alayer 2.5protocol. It was designed to provide a unified data-carrying service for bothcircuit-based clients and packet-switching clients which provide adatagramservice model. It can be used to carry many different kinds of traffic, including IPpackets, as well as nativeAsynchronous Transfer Mode(ATM),Frame Relay,Synchronous Optical Networking(SONET) orEthernet.
A number of different technologies were previously deployed with essentially identical goals, such as Frame Relay and ATM. Frame Relay and ATM uselabelsto moveframesor cells through a network. The header of the Frame Relay frame and the ATM cell refers to thevirtual circuitthat the frame or cell resides on. The similarity between Frame Relay, ATM, and MPLS is that at each hop throughout the network, thelabelvalue in the header is changed. This is different from theforwarding of IP packets.MPLS technologies have evolved with the strengths and weaknesses of ATM in mind. MPLS is designed to have lower overhead than ATM while providingconnection-oriented servicesfor variable-length frames, and has replaced much use of ATM in the market.MPLS dispenses with the cell-switching and signaling-protocol baggage of ATM. MPLS recognizes that small ATM cells are not needed in the core of modern networks, since modern optical networks are fast enough that even full-length 1500-byte packets do not incur significant real-time queuing delays.At the same time, MPLS attempts to preserve thetraffic engineering(TE) andout-of-band controlthat made Frame Relay and ATM attractive for deploying large-scale networks.
In 1996 a group fromIpsilon Networksproposed aflow management protocol.TheirIP Switchingtechnology, which was defined only to work over ATM, did not achieve market dominance.Cisco Systemsintroduced a related proposal, not restricted to ATM transmission, calledTag Switchingwith its Tag Distribution Protocol (TDP).It was a Cisco proprietary proposal, and was renamedLabel Switching. It was handed over to theInternet Engineering Task Force(IETF) for open standardization. The IETF formed the MPLS Working Group in 1997. Work involved proposals from other vendors, and development of a consensus protocol that combined features from several vendors' work.
Some time later it was recognized that the work on threaded indices by Girish Chandranmenon and George Varghese had invented the idea of using labels to represent destination prefixes that was central to tag switching.
One original motivation was to allow the creation of simple high-speed switches since for a significant length of time it was considered impractical to forward IP packets entirely in hardware. Advances inVLSIand in forwarding algorithms have made hardware forwarding of IP packets possible and common. The current advantages of MPLS primarily revolve around the ability to support multiple service models and perform traffic management. MPLS also offers a robust recovery frameworkthat goes beyond the simple protection rings ofsynchronous optical networking(SONET/SDH).
MPLS works by prefixing packets with an MPLS header, containing one or more labels. This is called a labelstack.
Each entry in the label stack contains four fields:
These MPLS-labeled packets are switched based on the label instead of a lookup in the IProuting table. When MPLS was conceived,label switchingwas faster than a routing table lookup because switching could take place directly within theswitched fabricand avoided CPU and software involvement.
The presence of such a label has to be indicated to the switch. In the case of Ethernet frames this is done through the use ofEtherTypevalues 0x8847 and 0x8848, forunicastandmulticastconnections respectively.
An MPLS router that performs routing based only on the label is called alabel switch router(LSR) ortransit router. This is a type of router located in the middle of an MPLS network. It is responsible for switching the labels used to route packets.
When an LSR receives a packet, it uses the label included in the packet header as an index to determine thenext hopon the label-switched path (LSP) and a corresponding label for the packet from aLabel Information Base. The old label is then removed from the header and replaced with the new label before the packet is routed forward.
Alabel edge router(LER, also known as edge LSR) is a router that operates at the edge of an MPLS network and acts as the entry and exit points for the network. LERspushan MPLS label onto an incoming packetandpopit off an outgoing packet. Alternatively, underpenultimate hop poppingthis function may instead be performed by the LSR directly connected to the LER.
When forwarding anIP datagraminto the MPLS domain, a LER uses routing information to determine the appropriate label to be affixed, labels the packet accordingly, and then forwards the labeled packet into the MPLS domain. Likewise, upon receiving a labeled packet that is destined to exit the MPLS domain, the LER strips off the label and forwards the resulting IP packet using normal IP forwarding rules.
In the specific context of an MPLS-basedvirtual private network(VPN), LERs that function asingressoregress routersto the VPN are often calledprovider edge(PE) routers. Devices that function only as transit routers are similarly calledprovider(P) routers.The job of a P router is significantly easier than that of a PE router.
Labels may be distributed between LERs and LSRs using theLabel Distribution Protocol(LDP)orResource Reservation Protocol(RSVP).LSRs in an MPLS network regularly exchange label and reachability information with each other using standardized procedures in order to build a complete picture of the network so that they can then use that information to forward the packets.
Label-switched paths (LSPs) are established by the network operator for a variety of purposes, such as to create network-based IP virtual private networks or to route traffic along specified paths through the network. In many respects, LSPs are not different frompermanent virtual circuits(PVCs) in ATM or Frame Relay networks, except that they are not dependent on a particular layer-2 technology.
When an unlabeled packet enters the ingress router and needs to be passed on to an MPLStunnel, the router first determines theforwarding equivalence class(FEC) for the packet and then inserts one or more labels in the packet's newly created MPLS header. The packet is then passed on to the next hop router for this tunnel.
From anOSI modelperspective, the MPLS Header is added between thenetwork layerheader andlink layerheader.
When a labeled packet is received by an MPLS router, the topmost label is examined. Based on the contents of the label aswap,pushorpopoperation is performed on the packet's label stack. Routers can have prebuilt lookup tables that tell them which kind of operation to do based on the topmost label of the incoming packet so they can process the packet very quickly.
During these operations, the contents of the packet below the MPLS Label stack are not examined. Indeed, transit routers typically need only to examine the topmost label on the stack. The forwarding of the packet is done based on the contents of the labels, which allows protocol-independent packet forwarding that does not need to look at a protocol-dependent routing table and avoids the expensive IPlongest prefix matchat each hop.
At the egress router, when the last label has been popped, only the payload remains. This can be an IP packet or any type of packet. The egress router must, therefore, have routing information for the packet's payload since it must forward it without the help of label lookup tables. An MPLS transit router has no such requirement.
Usually, the last label is popped off at the penultimate hop (the hop before the egress router). This is calledpenultimate hop popping(PHP). This is useful in cases where the egress router has many packets leaving MPLS tunnels and thus spends significant CPU resources on these transitions. By using PHP, transit routers connected directly to this egress router effectively offload it, by popping the last label themselves. In the label distribution protocols, this PHP label pop action is advertised as label value 3 (implicit null) and is never found in a label, since it means that the label is to be popped.
Several MPLS services including end-to-endQoSmanagement,and6PE,require keeping a label even between the penultimate and the last MPLS router, with a label disposition always done on the last MPLS router, ultimate hop popping (UHP).Some specific label values have been notably reservedfor this use. In this scenario the remaining label stack entry conveys information to the last hop (such as its Traffic Class field for QoS information), while also instructing the last hop to pop the label stack using one of the following reserved label values:
An MPLS header does not identify the type of data carried inside the MPLS path. To carry two different types of traffic between the same two routers, with different treatment by the core routers for each type, a separate MPLS path for each type of traffic is required.
A label-switched path (LSP) is a path through an MPLS network set up by theNMSor by a signaling protocol such asLDP,RSVP-TE,BGP(or the now deprecatedCR-LDP). The path is set up based on criteria in the FEC.
The path begins at an LER, which makes a decision on which label to prefix to a packet based on the appropriate FEC. It then forwards the packet along to the next router in the path, which swaps the packet's outer label for another label, and forwards it to the next router. The last router in the path removes the label from the packet and forwards the packet based on the header of its next layer, for exampleIPv4. Due to the forwarding of packets through an LSP being opaque to higher network layers, an LSP is also sometimes referred to as an MPLS tunnel.
The router which first prefixes the MPLS header to a packet is aningress router. The last router in an LSP, which pops the label from the packet, is called anegress router. Routers in between, which need only swap labels, are called transit routers or label switch routers (LSRs).
Note that LSPs are unidirectional; they enable a packet to be label switched through the MPLS network from one endpoint to another. Since bidirectional communication is typically desired, the aforementioned dynamic signaling protocols can automatically set up a separate LSP in the opposite direction.
Whenlink protectionis considered, LSPs can be categorized as primary (working), secondary (backup) and tertiary (LSP of last resort).
There are two standardized protocols for managing MPLS paths: theLabel Distribution Protocol(LDP) andRSVP-TE, an extension of theResource Reservation Protocol(RSVP) for traffic engineering.Furthermore, there exist extensions of theBorder Gateway Protocol(BGP) that can be used to manage an MPLS path.
Multicast was, for the most part, an afterthought in MPLS design. It was introduced by point-to-multipoint RSVP-TE.It was driven byservice providerrequirements to transport broadband video over MPLS.
The hub and spoke multipoint LSP (HSMP LSP) was also introduced by IETF. HSMP LSP is mainly used for multicast, time synchronization, and other purposes.
MPLS works in conjunction with the Internet Protocol (IP) and its routing protocols, usuallyinterior gateway protocols(IGPs). MPLS LSPs provide dynamic, transparent virtual networks with support for traffic engineering, the ability to transport layer-3 (IP) VPNs with overlapping address spaces, and support for layer-2pseudowiresusingPseudowire Emulation Edge-to-Edge(PWE3)that are capable of transporting a variety of transport payloads (IPv4,IPv6, ATM, Frame Relay, etc.). MPLS-capable devices are referred to as LSRs. The paths an LSR knows can be defined using explicit hop-by-hop configuration, or are dynamically routed by theConstrained Shortest Path First(CSPF) algorithm, or are configured as a loose route that avoids a particular IP address or that is partly explicit and partly dynamic.
In a pure IP network, the shortest path to a destination is chosen even when the path becomes congested. Meanwhile, in an IP network with MPLS Traffic Engineering CSPF routing, constraints such as the RSVP bandwidth of the traversed links can also be considered, such that the shortest path with available bandwidth will be chosen. MPLS Traffic Engineering relies upon the use of TE extensions toOpen Shortest Path First(OSPF) orIntermediate System to Intermediate System(IS-IS) and RSVP. In addition to the constraint of RSVP bandwidth, users can also define their own constraints by specifying link attributes and special requirements for tunnels to route (or not to route) over links with certain attributes.
For end-users the use of MPLS is not visible directly, but can be assumed when doing atraceroute: only nodes that dofullIP routing are shown as hops in the path, thus not the MPLS nodes used in between, therefore when you see that a packethopsbetween two very distant nodes and hardly any otherhopis seen in that provider's network (orAS) it is very likely that network uses MPLS.
In the event of a network element failure when recovery mechanisms are employed at the IP layer, restoration may take several seconds which may be unacceptable for real-time applications such asVoIP.In contrast,MPLS local protectionmeets the requirements of real-time applications with recovery times comparable to those ofshortest path bridgingnetworks orSONETrings of less than 50 ms.
MPLS can make use of existing ATM network or Frame Relay infrastructure, as its labeled flows can be mapped to ATM or Frame Relay virtual-circuit identifiers, and vice versa.
Frame Relayaimed to make more efficient use of existing physical resources, which allow for the underprovisioning of data services bytelecommunications companies(telcos) to their customers, as clients were unlikely to be utilizing a data service 100 percent of the time. Consequently,oversubscriptionof capacity by the telcos, while financially advantageous to the provider, can directly affect overall performance.
Telcos often sold Frame Relay to businesses looking for a cheaper alternative todedicated lines; its use in different geographic areas depended greatly on governmental and telecommunication companies' policies.
Many customers migrated from Frame Relay to MPLS over IP or Ethernet, which in many cases reduced costs and improved manageability and performance of their wide area networks.
While the underlying protocols and technologies are different, both MPLS andATMprovide a connection-oriented service for transporting data across computer networks. In both technologies, connections are signaled between endpoints, the connection state is maintained at each node in the path, and encapsulation techniques are used to carry data across the connection. Excluding differences in the signaling protocols (RSVP/LDP for MPLS andPNNIfor ATM) there still remain significant differences in the behavior of the technologies.
The most significant difference is in the transport and encapsulation methods. MPLS is able to work with variable-length packets while ATM uses fixed-length (53 bytes) cells. Packets must be segmented, transported and re-assembled over an ATM network using an adaptation layer, which adds significant complexity and overhead to the data stream. MPLS, on the other hand, simply adds a label to the head of each packet and transmits it on the network.
Differences exist, as well, in the nature of the connections. An MPLS connection (LSP) is unidirectional, allowing data to flow in only one direction between two endpoints. Establishing two-way communications between endpoints requires a pair of LSPs be established. Because two LSPs are used, data flowing in the forward direction may use a different path from data flowing in the reverse direction. ATM point-to-point connections (virtual circuits), on the other hand, arebidirectional, allowing data to flow in both directions over the same path.
Both ATM and MPLS support tunneling of connections inside connections. MPLS uses label stacking to accomplish this while ATM usesvirtual paths. MPLS can stack multiple labels to form tunnels within tunnels. The ATM virtual path indicator (VPI) and virtual circuit indicator (VCI) are both carried together in the cell header, limiting ATM to a single level of tunneling.
The biggest advantage that MPLS has over ATM is that it was designed from the start to be complementary to IP. Modern routers can support both MPLS and IP natively across a common interface allowing network operators great flexibility innetwork designand operation. ATM's incompatibilities with IP require complex adaptation, making it comparatively less suitable for today's predominantly IP networks.
MPLS is standardized by the IETF inRFC3031. It is deployed to connect as few as two facilities to very large deployments. In practice, MPLS is mainly used to forwardIPprotocol data units (PDUs) andVirtual Private LAN Service(VPLS) Ethernet traffic. Major applications of MPLS are telecommunications traffic engineering, andMPLS VPN.
MPLS was originally proposed to allow high-performance traffic forwarding andtraffic engineeringin IP networks. However, it evolved inGeneralized MPLS(GMPLS) to also allow the creation of LSPs in non-native IP networks, such asSONET/SDH networksandwavelength switched optical networks.
MPLS can exist in both anIPv4and anIPv6environment, using appropriate routing protocols. The major goal of MPLS development was the increase of routing speed.This goal is no longer relevantbecause of the usage of newer switching methods such asASIC,TCAMandCAM-based switching able to forward plain IPv4 as fast as MPLS labeled packets.Now, therefore, the main benefitof MPLS is to implement limited traffic engineering and layer 3 or layer 2 service provider type VPNs over IPv4 networks.